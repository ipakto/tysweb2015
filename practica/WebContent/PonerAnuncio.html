<!DOCTYPE html>
<html>
<head>
<meta charset="ISO-8859-1">
<title>Insert title here</title>
</head>
<body>
<p>
	<label for="categoria">Categoria</label>
	<select id="categoria">
		<option></option>
	</select>
</p>
<form id="formFoto" enctype="multipart/form-data" style="display:none;">
	<label for="foto">Fotos</label><input type="file" id="foto" name="foto" accept="image/*"><br>
	<button type="button" id="guardar" onclick="subirFoto()">Subir</button>
	<div id="progreso"></div>
</form>
<div id="zonaDeFotos"></div>
<script>

		
		function subirFoto(){
			var request= new XMLHttpRequest();
			var progreso=document.getElementById("progreso");
			var f=document.getElementById("formFoto");
			var formData=new FormData(f);
			request.open("POST", "SubirFoto.action");
			request.onreadystatechange=function(){
				if(request.readyState==3){
					progreso.innerHTML="Respuesta Recibida";
				}
				if(request.readyState==4){
					var respuesta=JSON.parse(request.responseText);
					respuesta=JSON.parse(respuesta.resultado);
					if(request.status==200){
						progreso.innerHTML="Foto subida correctamente. Id="+respuesta.mensaje;
						cargarZonaDeFotos();
						alert(respuesta.resultado);
					}else{
						progreso.innerHTML=respuesta.mensaje;
					}
				}
			}
			request.send(formData);
		}
	</script>
</body>
</html>
